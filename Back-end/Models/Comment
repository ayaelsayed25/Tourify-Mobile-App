const table = 'Comments';
const { TIMESTAMP } = require("mysql/lib/protocol/constants/types");
const DB = require("../DB/pool");
const tableName = 'Comments';

module.exports = {

    tableName: tableName,

    create: async (comment,cb) => {
        let insertQuery = `INSERT INTO ${tableName} 
            (post_id,email, body)  VALUES
            ("${comment.post_id}","${comment.email}","${comment.body}") ;`;
        try {
            let res = await DB(insertQuery)
            console.log(res)
            return cb(null, res);

        } catch (e) {
            console.log(e)
            return cb(e, null);
        }
    },

    
    edit: async (comment,cb) => {
        let editQuery = `UPDATE ${tableName} 
            SET body = "${comment.body}"
            WHERE
                email = "${email}" AND post_id = ${comment.postId};`
            console.log(editQuery)
        try {
            let res = await DB(editQuery)
            console.log(res)
            return cb(null, res);
        }
        catch (e) {
            return cb(e, null);
        }
    },

    delete: async (comment_id,cb) => {

        let query = `DELETE FROM  ${tableName} WHERE  comment_id = ${comment_id} `;

        try {

            await DB(query)

            return cb(null);

        } catch (e) {
            console.log(e)
            return cb(e);

        }

    },
    
    getOne: async (comment_id, cb) => {
        if (!comment_id)
            return cb(null, null)

        let query = `SELECT * FROM  ${tableName} WHERE  comment_id = ${comment_id} `;

        try {

            let comment = await DB(query)

            return cb(null, comment);

        } catch (e) {
            console.log(e)
            return cb(e, null);

        }
    }

}